<!DOCTYPE html>
<html>
<head>
	<title>Data</title>
	<meta charset="utf-8">
</head>
<body>
<div id="stuffhere"></div>
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
<!-- http://letsrevolutionizetesting.com/challenge.json -->
<!-- https://gist.githubusercontent.com/davidpaulhunt/b2d70397bd6c64e0d77f039e6f6cc223/raw/5d8797b8c82a5ccb36145a28bb31ec8dbb91c708/tryingJSON.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.21.0/moment.min.js"></script>
<script type="text/javascript">
	//////////////////////////////////
	// Fetch data
	function fetchData(){
		return new Promise((resolve, reject)=>{
			// let d_lifts = [];
			// fetch('lift.json')
			// .then(blob => blob.json())
			// .then(data => d_lifts.push(...data));

			let d_cardio = [];
			fetch('cardio.json')
			.then(blob => blob.json())
			.then(data => {
				d_cardio.push(...data);
				resolve(d_cardio);
			});
		});
	}
	//////////////////////////////////
	// Select working chunk
	fetchData().then(d_cardio => {
		d_cardio.sort((a, b) => a.workout_date < b.workout_date);
		let cardio_chunk = d_cardio.slice(0, 100).map( c => {
			let n = {};
			let wd = new Date(c.workout_date);
			n.x = wd.getDay() * 100;
			n.y = c.duration;
			return n;
		}).sort((a, b)=> a.x < b.x);
		console.log(cardio_chunk);
		let cnt = d3.select('#stuffhere').append('svg').attr('width', 800).attr('height', 600);
		let lnfun = d3.svg.line().x(function(d){ return d.x; }).y(function(d){ return d.y }).interpolate('linear');
		let lngrph = cnt.append('path').attr('d', lnfun(cardio_chunk)).attr('stroke', '#380ab5').attr('stroke-width', 2).attr('fill', 'none');
	});
	
</script>
</body>
</html>